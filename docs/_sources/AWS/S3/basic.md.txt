# S3の基本情報
S3（Amazon Simple Storage Service)は高い耐久性と可用性を備える無制限のオブジェクト型ストレージである。

## オブジェクトストレージ
オブジェクト型とは、ストレージに保管するデータをオブジェクトという単位で管理するストレージ。
オブジェクトに対してはキーやメタデータが付与される。

### バケット
オブジェクトの格納場所であり、オブジェクトを保管するルートとなる。
オブジェクトを指し示すURLにも利用されるため、`全てのAWSアカウトでユニークである必要がある`。

### キー
オブジェクトを指し示すパスであり、

オブジェクトに割り当てることができるファイル名。
キーに対して、プレフィックスというフォルダ構成を付与することができる。

### メタデータ
アップロードしたオブジェクトの属性を記載したキーバリュー型のデータ。
AWSが用意しているファイルシステム定義とユーザーが任意に設定できるものもある。

### バージョン
バージョン指定をすることによってオブジェクトに対してバージョンIDを払い出してバージョン管理をすることが可能となる。



## 耐久性と可用性
S3は耐久性（どれだけデータをロストしないか）について、イレブンナインを補償しており、データのロストは限りなく低い。
また、可用性についても自動で複数のAZに配置されるため、99.9％を補償している。

## ストレージの種類
S3はイレブンナインを補償するなど高い可用性を担保しており、データの取り出しに関しても秒単位での取り出しが可能である。
ユースケースに応じては過剰なスペックとなっているため、耐久性や取り出し時間を犠牲にすることで、費用を低減するようなストレージが準備されている。


| 種類 | 耐久性 | 速度 | 特徴 |
|:------|:-------:|------:|------:|
| S3標準     | 3つのAZ       | 高スループット、低レイテンシー     | 標準     |
| S3 標準 – IA     | 3つのAZ       | 高スループット、低レイテンシー     | アクセスが少ない場合料金が安い     |
| S3 Intelligent-Tiering      | 3つのAZ       | 高スループット、低レイテンシー     | 自動でIAと標準を使い分ける     |
| S3 1 ゾーン – IA     | 1つのAZ       | 高スループット、低レイテンシー      | 可用性を落として費用を削減     |
| S3 Glacier Instant Retrieval     | 1つのAZに障害が発生しても復元可能       | 高スループット、低レイテンシー     | アクセスがほとんど無いがミリ秒単位のアクセスが必要     |
| S3 Glacier Flexible Retrieval (旧 S3 Glacier)     | 1つのAZに障害が発生しても復元可能       | 数分から数時間のアクセス時間     | ほぼ利用されないデータで即時性が求められないもの     |
| Amazon S3 Glacier Deep Archive     | 3つのAZ       | 取り出し時間は 12 時間以内     | 7～10 年以上データセットを保管するように設計     |

## S3のコスト
正確には、公式ドキュメントの[Amazon S3 の料金](https://aws.amazon.com/jp/s3/pricing/)参照。

ざっくり理解したい場合には[AWS S3 の料金をざっくり10GB単位で見る](https://zenn.dev/mryhryki/articles/2020-10-09-hatena-aws-s3-pricing)が参考になる。

### S3リクエスタ支払い
S3へのリクエストした側にリクエスト料金とデータ転送料金を請求することができる。

支払いが関連するのでAWSアカウントからしかアクセスできなくなる。
リクエストヘッダーに必ず`x-amz-request-payer`を追加する必要があり、このリクエストヘッダーを持って支払いに了承したとして扱う。
