# エクセル
エクセルを活用するために知っておくべきことは「関数」「機能」「アイデア」
- 関数：主要な70個程度覚えておけば十分
- 機能：主要な9個を覚えておけば十分
- 工夫・アイデア：上記を上手に利用して仕事を効率化する

また、知識としてエクセルには3つの使い方がある
- インプット
- マスター
- アウトプット

アウトプットは人に見せるために利用するものなので結合などもしても良いが、インプットやマスターは表計算ソフトとして、利用するので、データベースのように扱うことが基本となる。なので、セル結合や空白行などは避けて第1正規化された状態にする。

## データベースとしてのエクセル
### 原則
|原則|説明|
|:----|:----|
|数値再利用の原則|絶対に数値のみを入力し、単位は含めない。|
|列全体参照の原則|関数を利用する時に範囲は"(B:B)"としてB列全体を参照するようにしておく|


### データ
エクセルに投入するデータは4つ
- 数値
- 文字列
- 日付・時刻
- 数式・関数

#### 日付・時刻について
日付は、実態としてはシリアル値で管理されており、実態は「1900年1月1日」を1として、その日からの日数で管理されている。
そのため、エクセルにおいては必ず日付は西暦まで含めて管理されている点に注意。

時刻もシリアル値として管理されており、1以上の数字は日付に利用されているので0から1までの少数の間を利用している。00:00:00を0として、具体的には1秒ごとに86,400分の1の数字を足す。
小数の利用は誤差の元なので、TIME関数やHORU/MINUTE/SECOND関数を利用する。

### Tips
#### ショートカット
|コマンド|説明|
|:----|:----|
|Ctrl+:|現在の時刻|
|Ctrl+;|本日の日付|
|Ctrl+1|セルの書式設定|
|Ctrl+D|上のセルの複写|
|Ctrl+R|左のセルの複写|
|Shift+F11|シートの追加|
|Ctrl+"-"|セル・行・列の削除|
|Shift+Ctrl+"+"|セル・行・列の追加|
|Alt+Shift+=|オートSUM：上の行のsum関数を自動入力|
|Ctrl+Shift+!|表示を桁区切りにする|
|Ctrl+Shift+%|表示を%にする|

#### 便利関数
|機能|手順|
|:----|:----|
|CONCATENATE|文字列の結合|
|COUNTA|指定した範囲の空白以外のセルを数える|
|SUBSTITUTE|特定文字列の置換|
|SUMIF|条件一致した行のみの和を取る|
|SUMIFS|複数条件一致した行のみの和を取る|
|COUNTIF|条件一致した行の個数を数える|
|COUNTIF|複数条件一致した行の個数を数える|
|VLOOKUP|辞書機能。引数をkeyとして別途準備した辞書からValueを入れる|
|MATCH|検索対象において、何行目に存在するかの相対位置を返す|
|ROW|表上で何行目かを返す|
|COLUMN|表上で何列目かを返す|
|IFERROR|ERRORの場合でIF分岐(エクセルの見栄えを綺麗にしてくれる)|
|HOUR|HH:MM:SS表記からHHを抽出|
|MINUTE|HH:MM:SS表記からMMを抽出|
|SECOND|HH:MM:SS表記からSSを抽出|
|DATE|YYYY/MM/DDの値を引数にしてシリアル値を算出する|


#### 便利機能
|機能|手順|
|:----|:----|
|参照状況の確認|数式>参照元/先のトレース|
|連番の作成|1を入力したセルの選択>ホーム>フィル>連続データの作成|
|テーブル・構造化参照|対象のテーブルを選択してCtrl+T<br>数式がせるの参照ではなく表の列名を利用してくれるようになり、可読性が上がる。|

#### おせっかい機能の停止
|機能|手順|
|:----|:----|
|文字列の自動補完|エクセルのオプション>詳細設定>オートコンプリートを使用する|
|自動のハイパーリンク|ファイル>オプション>Excelのオプション>文章構成>オートコレクトのオプション>入力オートフォーマット>ハイパーリンクに変更する|
|セルの色付き三角をなくす|Excelのオプション>数式>エラーチェック・バックグラウンドでエラーチェックのチェックを外す|
